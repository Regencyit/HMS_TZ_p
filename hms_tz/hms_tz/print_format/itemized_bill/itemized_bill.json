{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2021-03-18 16:45:22.466931",
 "css": "",
 "custom_format": 0,
 "disabled": 1,
 "doc_type": "Patient Appointment",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<hr>\\n<div class=\\\"print-heading\\\">\\n    <h2 class=\\\"text-center\\\">Itemized Bill</h2>\\n</div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Patient Information\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"patient\", \"print_hide\": 0, \"label\": \"Patient\"}, {\"fieldname\": \"patient_name\", \"print_hide\": 0, \"label\": \"Patient Name\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"appointment_type\", \"print_hide\": 0, \"label\": \"Appointment Type\"}, {\"fieldname\": \"appointment_datetime\", \"print_hide\": 0, \"align\": \"left\", \"label\": \"Appointment Date\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Insurance or Company Information\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"insurance_company_name\", \"print_hide\": 0, \"label\": \"Insurance Company Name\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"insurance_subscription\", \"print_hide\": 0, \"label\": \"Insurance Subscription\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"\\n\\n<br><br>\\n {% set consultancy = frappe.db.get_all('Sales Invoice Item', {'reference_dn': doc.name}, ['parent', 'item_code','item_name','qty','uom','rate','amount']) %}\\n<h4>Consultation</h4>\\n<TABLE border=1 style=\\\"width: 100%; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n    <COLGROUP>\\n        <COL WIDTH=\\\"2%\\\">\\n        <COL WIDTH=\\\"38%\\\">\\n        <COL WIDTH=\\\"20%\\\">\\n        <COL WIDTH=\\\"10%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        \\n    </COLGROUP>\\n    <THEAD style=\\\"background-color: darkgray;\\\">\\n        <TR>\\n            <TH style=\\\"text-align: center;\\\">&nbsp;</TH>\\n            <TH style=\\\"text-align: center;\\\">Description</TH>\\n            <TH style=\\\"text-align: center;\\\">Invoice No</TH>\\n            <TH style=\\\"text-align: center;\\\">Qty</TH>\\n            <TH style=\\\"text-align: center;\\\">Rate</TH>\\n            <TH style=\\\"text-align: center;\\\">Amount</TH>\\n            \\n        </TR>\\n    </THEAD>\\n    {% set consult_total = [0] %}\\n    {% for item in consultancy %}\\n        {% set consult_total = consult_total.append(consult_total.pop() + item.amount) %}\\n        <TR>\\n            <TD style=\\\"text-align: center;\\\">{{ loop.index }}</TD>\\n            <TD style=\\\"text-align: left;\\\">{{ item.item_name }}</TD>\\n            <TD style=\\\"text-align: center;\\\"><small>{{ item.parent }}</small></TD>\\n            <TD style=\\\"text-align: center;\\\">{{ item.qty|int }}&nbsp;<small>{{ item.uom }}</small></TD>\\n            <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.rate, precision=2) }}</TD>\\n            <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.amount, precision=2) }}</TD>\\n            \\n        </TR>\\n    {% endfor %}\\n    <TR>\\n        <TD style=\\\"text-align: center;\\\">&nbsp;</TD>\\n        <TD style=\\\"text-align: left;\\\" colspan=\\\"4\\\">TOTAL</TD>\\n        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(consult_total[0], precision=2) }}</TD>\\n        \\n    </TR>\\n</TABLE>\\n\\n\\n<br><br>\\n<h4>Lab Tests</h4>\\n<table border=1 style=\\\"width: 100%; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n    <COLGROUP>\\n        <COL WIDTH=\\\"2%\\\">\\n        <COL WIDTH=\\\"38%\\\">\\n        <COL WIDTH=\\\"20%\\\">\\n        <COL WIDTH=\\\"10%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        \\n    </COLGROUP>\\n    <THEAD style=\\\"background-color: darkgray;\\\">\\n        <TR>\\n            <TH style=\\\"text-align: center;\\\">&nbsp;</TH>\\n            <TH style=\\\"text-align: center;\\\">Description</TH>\\n            <TH style=\\\"text-align: center;\\\">Invoice No</TH>\\n            <TH style=\\\"text-align: center;\\\">Qty</TH>\\n            <TH style=\\\"text-align: center;\\\">Rate</TH>\\n            <TH style=\\\"text-align: center;\\\">Amount</TH>\\n            \\n        </TR>\\n    </THEAD>\\n    {% set lab_total = [0] %}\\n    {% set encounters = frappe.db.get_all('Patient Encounter', {'appointment': doc.name}, ['name']) %}\\n        {% for encounter in encounters %}\\n            {% set enc_hsos = frappe.db.get_all('Healthcare Service Order', {'order_group': encounter.name, 'order_doctype': 'Lab Test Template'}, ['name']) %}\\n            {% for hso in enc_hsos %}\\n                {% set hso_inv = frappe.db.get_all('Sales Invoice Item', {'reference_dn': hso.name}, ['parent', 'item_code','item_name','qty','uom','rate','amount']) %}\\n                {% for item in hso_inv %}\\n                    {% set lab_total = lab_total.append(lab_total.pop() + item.amount) %}\\n                    <TR>\\n                        <TD style=\\\"text-align: center;\\\">{{ loop.index }}</TD>\\n                        <TD style=\\\"text-align: left;\\\">{{ item.item_name }}</TD>\\n                        <TD style=\\\"text-align: center;\\\"><small>{{ item.parent }}</small></TD>\\n                        <TD style=\\\"text-align: center;\\\">{{ item.qty|int }}&nbsp;<small>{{ item.uom }}</small></TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.rate, precision=2) }}</TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.amount, precision=2) }}</TD>\\n                        \\n                    </TR>\\n                {% endfor %}\\n            {% endfor %}\\n        {% endfor %}\\n    <TR>\\n        <TD style=\\\"text-align: center;\\\">&nbsp;</TD>\\n        <TD style=\\\"text-align: left;\\\" colspan=\\\"4\\\">TOTAL</TD>\\n        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(lab_total[0], precision=2) }}</TD>\\n        \\n    </TR>\\n</table>\\n\\n\\n<br><br>\\n<h4>Radiology Examinations</h4>\\n<table border=1 style=\\\"width: 100%; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n    <COLGROUP>\\n        <COL WIDTH=\\\"2%\\\">\\n        <COL WIDTH=\\\"38%\\\">\\n        <COL WIDTH=\\\"20%\\\">\\n        <COL WIDTH=\\\"10%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        \\n    </COLGROUP>\\n    <THEAD style=\\\"background-color: darkgray;\\\">\\n        <TR>\\n            <TH style=\\\"text-align: center;\\\">&nbsp;</TH>\\n            <TH style=\\\"text-align: center;\\\">Description</TH>\\n            <TH style=\\\"text-align: center;\\\">Invoice No</TH>\\n            <TH style=\\\"text-align: center;\\\">Qty</TH>\\n            <TH style=\\\"text-align: center;\\\">Rate</TH>\\n            <TH style=\\\"text-align: center;\\\">Amount</TH>\\n            \\n        </TR>\\n    </THEAD>\\n    {% set rad_total = [0] %}\\n   {% set encounters = frappe.db.get_all('Patient Encounter', {'appointment': doc.name}, ['name']) %}\\n        {% for encounter in encounters %}\\n            {% set enc_hsos = frappe.db.get_all('Healthcare Service Order', {'order_group': encounter.name, 'order_doctype': 'Radiology Examination Template'}, ['name']) %}\\n            {% for hso in enc_hsos %}\\n                {% set hso_inv = frappe.db.get_all('Sales Invoice Item', {'reference_dn': hso.name}, ['parent', 'item_code','item_name','qty','uom','rate','amount']) %}\\n                {% for item in hso_inv %}\\n                    {% set rad_total = rad_total.append(rad_total.pop() + item.amount) %}\\n                    <TR>\\n                        <TD style=\\\"text-align: center;\\\">{{ loop.index }}</TD>\\n                        <TD style=\\\"text-align: left;\\\">{{ item.item_name }}</TD>\\n                        <TD style=\\\"text-align: center;\\\"><small>{{ item.parent }}</small></TD>\\n                        <TD style=\\\"text-align: center;\\\">{{ item.qty|int }}&nbsp;<small>{{ item.uom }}</small></TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.rate, precision=2) }}</TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.amount, precision=2) }}</TD>\\n                        \\n                    </TR>\\n                {% endfor %}\\n            {% endfor %}\\n        {% endfor %}\\n    <TR>\\n        <TD style=\\\"text-align: center;\\\">&nbsp;</TD>\\n        <TD style=\\\"text-align: left;\\\" colspan=\\\"4\\\">TOTAL</TD>\\n        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(rad_total[0], precision=2) }}</TD>\\n        \\n    </TR>\\n</table>\\n\\n\\n<br><br>\\n<h4>Clinical Procedure</h4>\\n<table border=1 style=\\\"width: 100%; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n    <COLGROUP>\\n        <COL WIDTH=\\\"2%\\\">\\n        <COL WIDTH=\\\"38%\\\">\\n        <COL WIDTH=\\\"20%\\\">\\n        <COL WIDTH=\\\"10%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        \\n    </COLGROUP>\\n    <THEAD style=\\\"background-color: darkgray;\\\">\\n        <TR>\\n            <TH style=\\\"text-align: center;\\\">&nbsp;</TH>\\n            <TH style=\\\"text-align: center;\\\">Description</TH>\\n            <TH style=\\\"text-align: center;\\\">Invoice No</TH>\\n            <TH style=\\\"text-align: center;\\\">Qty</TH>\\n            <TH style=\\\"text-align: center;\\\">Rate</TH>\\n            <TH style=\\\"text-align: center;\\\">Amount</TH>\\n            \\n        </TR>\\n    </THEAD>\\n    {% set clin_total = [0] %}\\n   {% set encounters = frappe.db.get_all('Patient Encounter', {'appointment': doc.name}, ['name']) %}\\n        {% for encounter in encounters %}\\n            {% set enc_hsos = frappe.db.get_all('Healthcare Service Order', {'order_group': encounter.name, 'order_doctype': 'Clinical Procedure Template'}, ['name']) %}\\n            {% for hso in enc_hsos %}\\n                {% set hso_inv = frappe.db.get_all('Sales Invoice Item', {'reference_dn': hso.name}, ['parent', 'item_code','item_name','qty','uom','rate','amount']) %}\\n                {% for item in hso_inv %}\\n                    {% set clin_total = clin_total.append(clin_total.pop() + item.amount) %}\\n                    <TR>\\n                        <TD style=\\\"text-align: center;\\\">{{ loop.index }}</TD>\\n                        <TD style=\\\"text-align: left;\\\">{{ item.item_name }}</TD>\\n                        <TD style=\\\"text-align: center;\\\"><small>{{ item.parent }}</small></TD>\\n                        <TD style=\\\"text-align: center;\\\">{{ item.qty|int }}&nbsp;<small>{{ item.uom }}</small></TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.rate, precision=2) }}</TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.amount, precision=2) }}</TD>\\n                        \\n                    </TR>\\n                {% endfor %}\\n            {% endfor %}\\n        {% endfor %}\\n    <TR>\\n        <TD style=\\\"text-align: center;\\\">&nbsp;</TD>\\n        <TD style=\\\"text-align: left;\\\" colspan=\\\"4\\\">TOTAL</TD>\\n        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(clin_total[0], precision=2) }}</TD>\\n        \\n    </TR>\\n</table>\\n\\n\\n<br><br>\\n<h4>Medications</h4>\\n<table border=1 style=\\\"width: 100%; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n    <COLGROUP>\\n        <COL WIDTH=\\\"2%\\\">\\n        <COL WIDTH=\\\"38%\\\">\\n        <COL WIDTH=\\\"20%\\\">\\n        <COL WIDTH=\\\"10%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        \\n    </COLGROUP>\\n    <THEAD style=\\\"background-color: darkgray;\\\">\\n        <TR>\\n            <TH style=\\\"text-align: center;\\\">&nbsp;</TH>\\n            <TH style=\\\"text-align: center;\\\">Description</TH>\\n            <TH style=\\\"text-align: center;\\\">Invoice No</TH>\\n            <TH style=\\\"text-align: center;\\\">Qty</TH>\\n            <TH style=\\\"text-align: center;\\\">Rate</TH>\\n            <TH style=\\\"text-align: center;\\\">Amount</TH>\\n            \\n        </TR>\\n    </THEAD>\\n    {% set med_total = [0] %}\\n   {% set encounters = frappe.db.get_all('Patient Encounter', {'appointment': doc.name}, ['name']) %}\\n        {% for encounter in encounters %}\\n            {% set enc_hsos = frappe.db.get_all('Healthcare Service Order', {'order_group': encounter.name, 'order_doctype': 'Medication'}, ['name']) %}\\n            {% for hso in enc_hsos %}\\n                {% set hso_inv = frappe.db.get_all('Sales Invoice Item', {'reference_dn': hso.name}, ['parent', 'item_code','item_name','qty','uom','rate','amount']) %}\\n                {% for item in hso_inv %}\\n                    {% set med_total = med_total.append(med_total.pop() + item.amount) %}\\n                    <TR>\\n                        <TD style=\\\"text-align: center;\\\">{{ loop.index }}</TD>\\n                        <TD style=\\\"text-align: left;\\\">{{ item.item_name }}</TD>\\n                        <TD style=\\\"text-align: center;\\\"><small>{{ item.parent }}</small></TD>\\n                        <TD style=\\\"text-align: center;\\\">{{ item.qty|int }}&nbsp;<small>{{ item.uom }}</small></TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.rate, precision=2) }}</TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.amount, precision=2) }}</TD>\\n                        \\n                    </TR>\\n                {% endfor %}\\n            {% endfor %}\\n        {% endfor %}\\n    <TR>\\n        <TD style=\\\"text-align: center;\\\">&nbsp;</TD>\\n        <TD style=\\\"text-align: left;\\\" colspan=\\\"4\\\">TOTAL</TD>\\n        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(med_total[0], precision=2) }}</TD>\\n        \\n    </TR>\\n</table>\\n\\n<br><br>\\n<h4>Therapy Plan Details</h4>\\n<table border=1 style=\\\"width: 100%; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n    <COLGROUP>\\n        <COL WIDTH=\\\"2%\\\">\\n        <COL WIDTH=\\\"38%\\\">\\n        <COL WIDTH=\\\"20%\\\">\\n        <COL WIDTH=\\\"10%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        <COL WIDTH=\\\"15%\\\">\\n        \\n    </COLGROUP>\\n    <THEAD style=\\\"background-color: darkgray;\\\">\\n        <TR>\\n            <TH style=\\\"text-align: center;\\\">&nbsp;</TH>\\n            <TH style=\\\"text-align: center;\\\">Description</TH>\\n            <TH style=\\\"text-align: center;\\\">Invoice No</TH>\\n            <TH style=\\\"text-align: center;\\\">Qty</TH>\\n            <TH style=\\\"text-align: center;\\\">Rate</TH>\\n            <TH style=\\\"text-align: center;\\\">Amount</TH>\\n            \\n        </TR>\\n    </THEAD>\\n    {% set ther_total = [0] %}\\n   {% set encounters = frappe.db.get_all('Patient Encounter', {'appointment': doc.name}, ['name']) %}\\n        {% for encounter in encounters %}\\n            {% set enc_hsos = frappe.db.get_all('Healthcare Service Order', {'order_group': encounter.name, 'order_doctype': 'Therapy Plan Template Detail'}, ['name']) %}\\n            {% for hso in enc_hsos %}\\n                {% set hso_inv = frappe.db.get_all('Sales Invoice Item', {'reference_dn': hso.name}, ['parent', 'item_code','item_name','qty','uom','rate','amount']) %}\\n                {% for item in hso_inv %}\\n                    {% set ther_total = ther_total.append(ther_total.pop() + item.amount) %}\\n                    <TR>\\n                        <TD style=\\\"text-align: center;\\\">{{ loop.index }}</TD>\\n                        <TD style=\\\"text-align: left;\\\">{{ item.item_name }}</TD>\\n                        <TD style=\\\"text-align: center;\\\"><small>{{ item.parent }}</small></TD>\\n                        <TD style=\\\"text-align: center;\\\">{{ item.qty|int }}&nbsp;<small>{{ item.uom }}</small></TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.rate, precision=2) }}</TD>\\n                        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(item.amount, precision=2) }}</TD>\\n                        \\n                    </TR>\\n                {% endfor %}\\n            {% endfor %}\\n        {% endfor %}\\n    <TR>\\n        <TD style=\\\"text-align: center;\\\">&nbsp;</TD>\\n        <TD style=\\\"text-align: left;\\\" colspan=\\\"4\\\">TOTAL</TD>\\n        <TD style=\\\"text-align: right;\\\">{{ frappe.utils.fmt_money(ther_total[0], precision=2) }}</TD>\\n        \\n    </TR>\\n</table>\\n\\n\\n<br><br>\\n<h4>Overall Total</h4>\\n\\n{% set grand_total = consult_total[0] + lab_total[0] + rad_total[0] + clin_total[0] + med_total[0] + ther_total[0] %}\\n<table border=0 style=\\\"width: 80%; font-size: larger; border-collapse: collapse; border: 1px grey; margin-bottom: 10px;\\\">\\n   <tr>\\n        <td style=\\\"text-align: left;\\\"><b>GRAND TOTAL: </b></td>\\n        <td style=\\\"text-align: center;\\\"><b>{{ frappe.utils.fmt_money(grand_total, precision=2) }}</b></td>\\n    </tr>\\n    <tr>\\n        <td style=\\\"text-align: left;\\\"><b>Amount in Words: </b></td>\\n        <td style=\\\"text-align: center;\\\"><b>{{ frappe.utils.money_in_words(grand_total) }}</b></td>\\n    </tr>\\n</table>\\n<br>\\n\\n\\n\"}]",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2021-04-07 16:41:41.249791",
 "modified_by": "info@aakvatech.com",
 "module": "Hms Tz",
 "name": "Itemized Bill",
 "owner": "info@aakvatech.com",
 "print_format_builder": 1,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}